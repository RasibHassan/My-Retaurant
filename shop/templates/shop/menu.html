<style>
  


  .col-md-3 {
      display: inline-block;
      margin-left: -4px;
  }


  body .carousel-control-indicator li {
      background-color: blue;
  }

  body .carousel-control-prev-icon body .carousel-control-next-icon {
      background-color: blue;
  }

  body .no-padding {
      padding-left: 0;
      padding-right: 0!important;
  }

  .carousel-control-prev-icon {
      background-color: blue;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 8 8'%3e%3cpath d='M5.25 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z'/%3e%3c/svg%3e");
  }

  .carousel-control-next-icon {
      background-color: blue;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 8 8'%3e%3cpath d='M2.75 0l-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 4-4-4-4z'/%3e%3c/svg%3e");

  }
  body .carousel-indicators{
  bottom:0;
  }

  .carousel-indicators .active{
  background-color: blue;
  }
  .stack-top{
    z-index: 9;
    margin: 20px; /* for demo purpose  */
  }
  .overlay {
  z-index: 9;
  margin: 30px;
  } 

  @media (max-width: 1550px) {  
  .card{
    font-size: small!important;

  }
  .smallit{
    font-size: small!important;
  }
  h5 {
    font-size: medium!important;
  }
  h4 {
    font-size: medium!important;
  }
 
  }
  @media (max-width: 1200px) {
    .card{
      width:13rem!important;
    }

    }
    @media (max-width: 576px) {
    .card{
      width:auto!important;
    }
    .smallit2{
    font-size: medium!important;
    
    }
    h5 {
      font-size: large!important;
    }
    h4 {
      font-size: large!important;
    }
    #desc{
      font-size: x-small!important;
    }
    }
    @media (max-width: 400px) {
    .card{
      width:auto!important;
    }
    #desc{
      font-size: x-small!important;
    }
    .smallit2{
    font-size: x-small!important;
    }
    h5 {
      font-size: small!important;
    }
    h4 {
      font-size: small!important;
    }

    }

  



  




 
</style>
{% extends 'shop/basic.html' %}

{% block title%} Menu{% endblock %}

{% block body %}
{% load static %}
    <div class="alert alert-warning" role="alert">
      Exclusive 20% Discount On All items!
    </div>
    <div class="text-center text-success my-4">
      <h1 style='font-family: "Permanent Marker", sans-serif'> MENU </h1>
    </div>
    {% for product, range, nSlides in allProds %}
    <div class="container-fluid row align-items-center" style="width:auto">
      <div class="col-2 text-end d-none d-sm-block">
        <a href="#demo{{forloop.counter}}" data-slide="prev" class="btn btn-success" style="border-radius: 15px;width: 30px;height: 30px;padding: 6px 0px;align-items:center;justify-content:center; margin-top:140px">
          <i class="fa-solid fa-arrow-left" ></i>
        </a>
      </div>
      <div class="col-2 text-end d-sm-none">
        <a href="#demo2{{forloop.counter}}" data-slide="prev" class="btn btn-success" style="border-radius: 15px;width: 30px;height: 30px;padding: 6px 0px;text-align:center; margin-top:140px">
          <i class="fa-solid fa-arrow-left"></i>
        </a>
      </div>
      <div class="col-8">
        <hr class="border border-success border-1 opacity-50">
        <br>
        <br>
        <h3 class="my-4 text-center" style="font-family: 'Arvo', serif; color: rgb(27, 108, 24);">20% OFF ON {{product.0.sub_category|upper}}</h3>

        <div id="demo{{forloop.counter}}" class="carousel slide carousel-fade carousel-dark d-none d-sm-block" data-mdb-ride="carousel">
            <ul class="carousel-indicators">
              <li data-target="#demo{{forloop.counter}}" data-slide-to="0" class="active"></li>
              {% for i in range %}
              <li data-target="#demo{{forloop.parentloop.counter}}" data-slide-to="{{i}}" ></li>
              {% endfor %}
            </ul>
        
            <!--Slideshow starts here -->
            
            <div  class="container carousel-inner no-padding">
              
              <div  class="carousel-item active">
                
              {% for i in product %}
              <div class="col-3 col-sm-3 col-md-3 col-lg-3">
                <div class="card border-success mx-2 mb-3 gy-3 shadow" style="width: auto;">
                  <img src='/media/{{i.image}}' class="card-img-top img-fluid" alt="...">
                  <div class="card-body">
                    <h4 class="card-title text-success" id="namepr{{i.id}}" >{{i.product_name|upper}}</h4>
                    <h5 class=" text-success" id="pricepr{{i.id}}" style="font-family: 'Source Serif Pro', serif;">Rs.{{i.price}}</h5>
                    <p class="card-text">{{i.desc}}</p>
                      <div class="card text-center" >
                        <button id="pr{{i.id}}" class="btn btn-success cart shadow smallit"  >+ Add to cart</button>
                      </div>
                    </div>
                </div>
              </div>
  
              {% if forloop.counter|divisibleby:4 and forloop.counter > 0 and not forloop.last %}
                </div><div class="carousel-item">
              {% endif%}
  
              {% endfor %}
              </div>

        </div>
      </div>
      <!-- ************************************************* -->
      <div id="demo2{{forloop.counter}}" class="carousel slide carousel-fade carousel-dark d-sm-none" data-mdb-ride="carousel">
        <ul class="carousel-indicators">
          <li data-target="#demo2{{forloop.counter}}" data-slide-to="0" class="active"></li>
          {% for i in range %}
          <li data-target="#demo2{{forloop.parentloop.counter}}" data-slide-to="{{i}}" ></li>
          {% endfor %}
        </ul>
    
        <!--Slideshow starts here -->
        
        <div  class="container carousel-inner no-padding">
          
          <div  class="carousel-item active ">
            
          {% for i in product %}
          <div class="col-sm-3 ">
            <div class="card border-success mx-2 mb-3 shadow" style="width: auto;">
              <img src='/media/{{i.image}}' class="card-img-top img-fluid" alt="...">
              <div class="card-body text-center ">
                <h5 class="card-title text-success" id="namepr{{i.id}}" style="font-family: 'Alkalami', serif;">{{i.product_name|upper}}</h5>
                <h4 class="text-success" id="pricepr{{i.id}}" style="font-family: 'Source Serif Pro', serif;">Rs.{{i.price}}</h4>
                <p id="desc" class="card-text">{{i.desc}}</p>
                  <div class="card text-center" >
                    <button id="pr{{i.id}}" class="btn btn-success cart shadow smallit2"  >+ Add to cart</button>
                  </div>
                </div>
            </div>
          </div>

          {% if forloop.counter|divisibleby:forloop.counter and forloop.counter > 0 and not forloop.last %}
            </div><div class="carousel-item">
          {% endif%}

          {% endfor %}
          </div>

    </div>
  </div>
      </div>
      <div class="col-2 text-start d-none d-sm-block">
        <a id="arrowbtn" href="#demo{{forloop.counter}}" data-slide="prev" class="btn btn-success" style="border-radius: 15px;width: 30px;height: 30px;padding: 6px 0px;text-align:center; margin-top:140px">
          <i class="fa-solid fa-arrow-right"></i>
        </a>
      </div>
      <div class="col-2 text-start d-sm-none">
        <a href="#demo2{{forloop.counter}}" data-slide="prev" class="btn btn-success" style="border-radius: 15px;width: 30px;height: 30px;padding: 6px 0px;text-align:center; margin-top:140px">
          <i class="fa-solid fa-arrow-right"></i>
        </a>
      </div>
    </div> 
    </div>
    {% endfor %} 
    <div class="toast-container position-fixed bottom-0 start-0 p-3 " style="z-index:1; width:50%">
      <div id="liveToast" class="toast text-bg-success border border-2 border-warning " role="alert" aria-live="assertive" aria-atomic="true">
        <div id="msg" class="toast-body">
          added to cart
        </div>
      </div>
    </div>
          <!-- Optional JavaScript -->
          <!-- jQuery first, then Popper.js, then Bootstrap JS -->
          <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
          <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
            integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
            crossorigin="anonymous"></script>
          <!-- JavaScript Bundle with Popper -->
          <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
          
{% endblock %}

{% block js %}
<script>
console.log('working');
if(localStorage.getItem('cart') == null){
var cart = {};
}
else
{
cart = JSON.parse(localStorage.getItem('cart'));
}

$('.cart').click(function(){
console.log('clicked');
var idstr = this.id.toString();
console.log(idstr);
if (cart[idstr] !=undefined){
qty = cart[idstr][0] + 1;
name = document.getElementById('name'+idstr).innerHTML
cart[idstr] = [qty, name];

}
else
{
  qty = 1;
  name = document.getElementById('name'+idstr).innerHTML
  cart[idstr] = [qty, name];
}
console.log(cart);

display(cart);
updatePopover(cart);
totalprice(cart);
toastie(this.id);
});
function display(cart){
  sum=0
  for (var i in cart ){
    sum=sum+cart[i][0]
  }
  document.getElementById('cartno').innerHTML=sum;

}
function updatePopover(cart)
{
    if(Object.keys(cart).length === 0){
      popStr='<p id="cartitem">Empty Cart!</p> '
    }
    else{
      console.log('We are inside updatePopover');
      var popStr = "";
      popStr = popStr + '<hr class="border border-success border-1 opacity-25">';
      var i = 1;
      for (var item in cart){
          popStr = popStr + "<div class='row mx-2 my-2'><div class='col-6'>";
          popStr = popStr + "<h6>" + i +'. ' ;
          popStr = popStr + document.getElementById('name' + item).innerHTML.toUpperCase() +"</h6><p id='indvp'>(" +document.getElementById("price"+item).innerHTML.slice(3,)*cart[item][0]+")</p>"+'</div>'+'<div class="col-4 text-end"><button type="button" id="minus'+ item +'" class="btn btn-success btn-sm minus" onclick="minusItm(this.id)" >-</button> <span id="val'+ item + '"">'+ cart[item][0] + '</span> <button id="plus' + item + '" class="btn btn-success plus btn-sm" onclick="addItm(this.id)"> + </button></button></div><div class="col-2 text-end"><a id="del'+item+'"onclick="deletepr(this.id)"><i class="fas fa-trash-alt my-2 " style="color:green"></i></a></div>' + '<br>';
          i = i+1;
          popStr = popStr + "</div>" 
      }
    }
    document.getElementById('cartitem').innerHTML=popStr;
    localStorage.setItem('cart', JSON.stringify(cart))
  }

function minusItm(id){
    console.log(id);
    console.log('helklo');
    a = id.slice(7, );
    if(cart['pr' + a][0]==0){
      document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    }
    else{
    cart['pr' + a][0] = cart['pr' + a][0] - 1;
    document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    if(cart['pr' + a][0]==0){
      delete cart['pr' + a]
      display(cart)
    updatePopover(cart);
    totalprice(cart)
    }
    else{
    display(cart)
    updatePopover(cart);
    totalprice(cart)
    }}
}
function addItm(id){
    console.log(id);
    console.log('helklo');
    a = id.slice(6, );
    cart['pr' + a][0] = cart['pr' + a][0] + 1;
    document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    display(cart)
    updatePopover(cart);
    totalprice(cart)
}
function totalprice(cart){
  total=0;
  for (var item in cart){
    total=total+parseInt(document.getElementById("price"+item).innerHTML.slice(3,)*cart[item][0]);
    localStorage.setItem('total', total.toString())
}
  document.getElementById('totalp').innerHTML="Total Price: "+total
}
function deletepr(id){
  d = id.slice(5, );
  delete cart['pr' + d]
  updatePopover(cart)
  totalprice(cart)
  display(cart)
  console.log(cart)
  
}
function clearcart(){
  cart={}
  console.log(cart)
  updatePopover(cart)
  totalprice(cart)
  display(cart)
}
function toastie(id){
  document.getElementById('msg').innerHTML="<i class='fa-solid fa-check'></i> "+document.getElementById('name'+id.toString()).innerHTML+" ADDED TO CART"
  const toastTrigger = document.getElementById(id.toString())
  const toastLiveExample = document.getElementById('liveToast')
  if (toastTrigger) {
    const toast = new bootstrap.Toast(toastLiveExample)

    toast.show()
}

}
function myFunction(x) {
  if (x.matches) { // If media query matches
  } 
}

var x = window.matchMedia("(max-width: 700px)")
myFunction(x)
display(cart)

</script>
{% endblock %}